(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4916],{90643:function(e,n,r){"use strict";var t=r(59499),o=r(35944);function i(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function l(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?i(Object(r),!0).forEach(function(n){(0,t.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var u=function(e){var n=e.label,r=e.inputAttrs,t=e.placeholder;return(0,o.BX)("label",{className:"flex w-full justify-between",children:[(0,o.tZ)("span",{className:"text-gray-700",children:n}),(0,o.tZ)("input",l(l({type:"checkbox",className:" mt-1 block rounded-md border-main/50 shadow-sm focus:border-main focus:ring focus:ring-main/50 "},r),{},{placeholder:void 0===t?"":t}))]})};n.Z=u},62252:function(e,n,r){"use strict";var t=r(59499),o=r(4730),i=r(39299),l=r(87536),u=r(35944),a=["control","name","label","onChange"];function c(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function s(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?c(Object(r),!0).forEach(function(n){(0,t.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var d=function(e){var n=e.control,r=e.name,t=e.label,c=e.onChange,d=(0,o.Z)(e,a),f=(0,l.bc)({control:n,name:r}).field,p=d.isMulti?d.options.filter(function(e){var n;return null===(n=f.value)||void 0===n?void 0:n.includes(e.value)}):d.options.find(function(e){return e.value===f.value}),m=s(s({},d),{},{value:p,onChange:function(e){c?c(e):f.onChange(Array.isArray(e)?e.map(function(e){return e.value}):e.value)},className:"".concat(null==d?void 0:d.className," w-full"),isSearchable:!1});return(0,u.tZ)(u.HY,{children:t?(0,u.BX)("label",{children:[t,(0,u.tZ)(i.ZP,s({},m))]}):(0,u.tZ)(i.ZP,s({},m))})};n.Z=d},84805:function(e,n,r){"use strict";r.d(n,{Z:function(){return b}});var t=r(59499),o=r(78773),i=r(97088),l=r(87536),u=r(90643),a=r(90116),c=r(67294),s=r(73759),d=r(62252),f=r(35944),p=function(e){var n=e.control,r=e.roleType,t=(0,s.Z)(),o=t.roles;t.loading,t.error;var i=(0,l.bc)({control:n,name:"role_ids"}).field,u=o&&o.filter(function(e){return e.roleType===r}).filter(function(e){return"User"!==e.name}).map(function(e){return{value:e.id,label:e.name}});return(0,c.useEffect)(function(){if(u&&!i.value){var e=[u.find(function(e){return"Learner"===e.label})];i.onChange(e.map(function(e){return e.value}))}},[o]),(0,f.tZ)(f.HY,{children:o&&(0,f.tZ)(d.Z,{onChange:function(e){var n=[].concat((0,a.Z)(e),(0,a.Z)(e.length?[]:[u.find(function(e){return"Learner"===e.label})]));i.onChange(n.map(function(e){return e.value}))},label:"Roles",control:n,name:"role_ids",isMulti:!0,options:u})})},m=r(77961);function g(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function v(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?g(Object(r),!0).forEach(function(n){(0,t.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var b=function(e){var n=e.user,r=void 0===n?null:n,t=e.onSubmit;console.log("user?.roles.map(role => role.id)"),console.log(null==r?void 0:r.roles.map(function(e){return e.id}));var a=v(v({},r),{},{firstName:null==r?void 0:r.firstName,lastName:null==r?void 0:r.lastName,role_ids:null==r?void 0:r.roles.map(function(e){return e.id})}),c=(0,l.cI)({defaultValues:a}),s=c.register,d=c.handleSubmit,g=c.control,b=c.formState.errors;c.watch;var O=function(e){t(e)};return(0,f.BX)("form",{className:"h-full w-full max-w-sm flex flex-col space-y-4",onSubmit:d(O),children:[(0,f.tZ)(i.Z,{label:"First name",placeholder:"First name",inputAttrs:s("firstName",{required:"First name is required",maxLength:{value:20,message:"Max length of the name is 20"}})}),b.firstName&&(0,f.tZ)("small",{className:"text-danger text-red-500",children:b.firstName.message}),(0,f.tZ)(i.Z,{label:"Last name",placeholder:"Last name",inputAttrs:s("lastName",{required:"Last is required",maxLength:{value:20,message:"Max length of the name is 20"}})}),b.lastName&&(0,f.tZ)("small",{className:"text-danger text-red-500",children:b.lastName.message}),(0,f.tZ)(i.Z,{label:"Email",placeholder:"email",inputAttrs:s("email",{required:"Email is required",maxLength:{value:40,message:"Max length of the name is 40"},pattern:{value:/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/i,message:"Please give valid email"}})}),b.email&&(0,f.tZ)("small",{className:"text-danger text-red-500",children:b.email.message}),(0,f.tZ)(m.Z,{buttonText:"Choose profile image",label:"Profile image",control:g,name:"profile_image",initialValue:null==r?void 0:r.profileImageUrl}),(0,f.tZ)(p,{control:g,roleType:"tenant_role"}),r?(0,f.tZ)(u.Z,{label:"Send the user an invitation email",inputAttrs:s("invite")}):(0,f.tZ)(u.Z,{label:"Send user an invitation upon creation",inputAttrs:s("invite")}),(0,f.tZ)(o.Z,{type:"submit",children:"Submit"})]})}},39106:function(e,n,r){"use strict";r.d(n,{EM:function(){return c},xt:function(){return a}});var t,o,i,l=r(71383),u=r(17283),a=(0,u.Ps)(t||(t=(0,l.Z)(["\n  fragment CapabilityFragment on Capability {\n    id\n    name\n    capabilityType\n    details\n    # _deleted @client\n  }\n"])));(0,u.Ps)(o||(o=(0,l.Z)(["\n  query GetCapability($id: ID!) {\n    capability(id: $id) {\n      ...CapabilityFragment\n    }\n  }\n  ","\n"])),a);var c=(0,u.Ps)(i||(i=(0,l.Z)(["\n  query GetCapabilities {\n    capabilities {\n      ...CapabilityFragment\n    }\n  }\n  ","\n"])),a)},26815:function(e,n,r){"use strict";r.d(n,{$r:function(){return s},Qi:function(){return d},o3:function(){return c}});var t,o,i,l=r(71383),u=r(17283),a=r(39106),c=(0,u.Ps)(t||(t=(0,l.Z)(["\n  fragment RoleFragment on Role {\n    id\n    name\n    roleType\n    _deleted @client\n  }\n"]))),s=(0,u.Ps)(o||(o=(0,l.Z)(["\n  query GetRole($id: ID!) {\n    role(id: $id) {\n      ...RoleFragment\n      capabilities {\n        ...CapabilityFragment\n      }\n    }\n  }\n  ","\n  ","\n"])),c,a.xt),d=(0,u.Ps)(i||(i=(0,l.Z)(["\n  query GetRoles {\n    roles {\n      ...RoleFragment\n      \n    }\n  }\n  ","\n"])),c)},55103:function(e,n,r){"use strict";var t=r(22345),o=r(71641);n.Z=function(){var e=(0,o.a)(t.Pb),n=e.loading,r=e.error,i=e.data;return{courses:(i=void 0===i?{}:i).courses,loading:n,error:r}}},73759:function(e,n,r){"use strict";var t=r(71641),o=r(26815);n.Z=function(){var e=(0,t.a)(o.Qi),n=e.loading,r=e.error,i=e.data;return{roles:(i=void 0===i?{}:i).roles,loading:n,error:r}}},77731:function(e,n,r){"use strict";r.d(n,{Z:function(){return m}});var t,o=r(59499),i=r(17674),l=r(71383),u=r(17283),a=r(50051),c=(0,u.Ps)(t||(t=(0,l.Z)(["\n  mutation UpdateUser(\n    $id: ID!\n    $firstName: String\n    $lastName: String\n    $email: String\n    $userType: String\n    $status: String\n  ) {\n    updateUser(\n      input: {\n      id: $id,\n      firstName: $firstName,\n      lastName: $lastName,\n      email: $email,\n      userType: $userType,\n      status: $status\n      }\n    ) {\n      user {\n      ...UserFragment\n      }\n    }\n  }\n  ","\n"])),a.mm),s=r(71641),d=r(50319);function f(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function p(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?f(Object(r),!0).forEach(function(n){(0,o.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=(0,s.a)(a.JA,{variables:{id:e}}),r=n.loading,t=n.error,o=n.data,l=(o=void 0===o?{}:o).user,u=(0,d.D)(c),f=(0,i.Z)(u,2),m=f[0];f[1];var g=function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=p({},n);m({variables:p({id:e},t),optimisticResponse:{updateUser:{__typename:"UpdateUserPayload",user:p(p({},l),t)}},onCompleted:r}).catch(function(e){})};return{user:l,loading:r,error:t,updateUser:g}}},94781:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return ew}});var t,o,i,l,u,a=r(4730),c=r(40350),s=r(24249),d=r(24545),f=r(10893),p=r(77731),m=r(84805),g=r(59499),v=r(17674),b=r(50319),O=r(71383),h=r(17283),y=r(50051),Z=(0,h.Ps)(t||(t=(0,O.Z)(["\n  mutation UpdateUserTenantRoles(\n    $userId: ID!,\n    $roleIds: [ID!]!\n  ) {\n    updateUserTenantRoles(\n      userId: $userId\n      roleIds: $roleIds\n    ) {\n      user {\n        ...UserFragment\n      }\n    }\n  }\n  ","\n"])),y.mm);function j(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}var P=function(){var e,n=(0,b.D)(Z),r=(0,v.Z)(n,2),t=r[0],o=r[1];return{updateUserTenantRoles:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t({variables:function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?j(Object(r),!0).forEach(function(n){(0,g.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}({},e),onCompleted:n}).catch(function(e){})},user:null==o?void 0:null===(e=o.data)||void 0===e?void 0:e.updateUserTenantRoles.user}},w=r(67294),I=r(95815),D=r(35944),C=function(e){var n=e.title,r=e.button,t=void 0===r?null:r,o=e.icon,i=void 0===o?null:o,l=e.children,u=function(){return(0,D.tZ)("a",{href:"#",onClick:null==t?void 0:t.onClick,className:" text-main hover:text-main-secondary",children:null==t?void 0:t.text})};return(0,D.BX)("div",{className:"bg-white shadow-xl rounded-md containerClassname",children:[(0,D.BX)("div",{className:"bg-main/20 rounded-t-md flex justify-between items-center px-3 py-2",children:[(0,D.BX)("div",{className:"flex text-main-secondary",children:[i&&(0,D.tZ)(i,{className:"w-7 mr-2"}),(0,D.tZ)("h3",{children:n})]}),t&&(0,D.tZ)(u,{})]}),l]})},x=(0,h.Ps)(o||(o=(0,O.Z)(["\n  mutation AddUsersToGroups(\n    $userIds: [ID!]!,\n    $groupIds: [ID!]!\n    $roleId: ID\n  ) {\n    addUsersToGroups(\n      userIds: $userIds,\n      groupIds: $groupIds\n      roleId: $roleId\n    ) {\n      groups {\n        id\n        name\n        users {\n          nodes {\n            id\n          }\n        }\n      }\n      users {\n        id\n        groups {\n          nodes {\n            id\n          }\n        }\n      }\n    }\n  }\n"])));function N(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}var E=function(){var e,n,r=(0,b.D)(x),t=(0,v.Z)(r,2),o=t[0],i=t[1],l=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;o({variables:function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?N(Object(r),!0).forEach(function(n){(0,g.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}({},e),onCompleted:n}).catch(function(e){})};return{groups:null==i?void 0:null===(e=i.data)||void 0===e?void 0:null===(n=e.addUsersToGroups)||void 0===n?void 0:n.groups,addUsersToGroups:l}};r(89872);var S=r(70442),U=r(73759),$=r(5564),k=(0,h.Ps)(i||(i=(0,O.Z)(["\n  mutation RemoveUserFromGroup(\n    $userId: ID!,\n    $groupId: ID!\n  ) {\n    removeUserFromGroup(\n      userId: $userId,\n      groupId: $groupId\n    ) {\n      membership {\n        user {\n          fullName\n        }\n      }\n    }\n  }\n"])));function _(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}var M=function(){var e,n,r=(0,b.D)(k),t=(0,v.Z)(r,2),o=t[0],i=t[1],l=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;o({variables:function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?_(Object(r),!0).forEach(function(n){(0,g.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}({},e),onCompleted:n}).catch(function(e){})};return{groups:null==i?void 0:null===(e=i.data)||void 0===e?void 0:null===(n=e.removeUserFromGroup)||void 0===n?void 0:n.groups,removeUserFromGroup:l}},T=r(39299);function F(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function R(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?F(Object(r),!0).forEach(function(n){(0,g.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var A=function(e){var n=e.cell,r=e.roleType,t=e.onChange,o=(0,U.Z)(),i=(o.loading,o.error,o.roles),l=n.row.original.roles,u={options:i&&i.filter(function(e){return e.roleType===r&&"User"!==e.name}),getOptionLabel:function(e){return e.name},getOptionValue:function(e){return e.name},defaultValue:l[0],menuPortalTarget:document.body,isSearchable:!1,onChange:t,styles:{menuPortal:function(e){return R(R({},e),{},{zIndex:9999})},control:function(e,n){return R(R({},e),{},{border:"none",background:"transparent",marginLeft:"-8px"})}}};return(0,D.tZ)("div",{className:"flex space-x-4",children:i&&(0,D.tZ)(D.HY,{children:(0,D.tZ)(T.ZP,R({},u))})})};function X(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}var q=function(){var e=(0,s.t)().query.id,n=(0,f.Z)(e),r=(n.loading,n.error,n.user),t=(0,U.Z)(),o=(t.loading,t.error,t.roles),i=E().addUsersToGroups,l=M().removeUserFromGroup,u=(0,w.useCallback)(function(e,n){if(!(null!=r&&r.id))return!1;l({userId:r.id,groupId:e.node.id}),i({userIds:[r.id],groupIds:[e.node.id],roleId:n.id})},[r]),a=function(e){l({userId:r.id,groupId:e})};(0,w.useContext)(I.t).handleModal;var c=(0,w.useMemo)(function(){return(null==r?void 0:r.groups.edges.filter(function(e){return!e.node._deleted}))||[]},[r]),d=(0,w.useMemo)(function(){return[{header:"Group",accessorFn:function(e){return e.node.name},cell:function(e){var n={title:e.cell.row.original.node.name,style:{width:"200px"}};return(0,D.tZ)(S.Z,function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?X(Object(r),!0).forEach(function(n){(0,g.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}({},n))}},{header:function(){return(0,D.tZ)("span",{className:"block w-full text-left",children:"Role"})},accessorKey:"roles",cell:function(e){var n=e.cell,r=n.row.original,t=function(e){return u(r,e)};return(0,D.tZ)(A,{onChange:t,cell:n,roleType:"group_role"})}},{width:300,id:"Actions",cell:function(e){var n=e.cell;return n.row.original,(0,D.tZ)("div",{className:"text-right",children:(0,D.tZ)("a",{className:"text-red-600 hover:text-red-800 self-center",href:"#",onClick:function(){return a(n.row.original.node.id)},children:"Remove from group"})})}}]},[o]);return(0,D.tZ)($.Z,{tableData:c,tableCols:d})},B=r(97698),G=function(){var e=(0,s.t)(),n=e.query.id,r=(0,f.Z)(n);r.loading,r.error,r.user;var t=(0,w.useContext)(I.t);return t.handleModal,t.closeModal,(0,D.tZ)(C,{title:"Groups",icon:B.Y,button:{text:"Assign to groups",onClick:function(){e.push("/admin/users/groups")}},children:(0,D.tZ)(q,{})})},L=(0,h.Ps)(l||(l=(0,O.Z)(["\n  mutation EnrolUsersInContent(\n    $userIds: [ID!]!,\n    $contentItemIds: [ID!]!\n    $roleId: ID!\n  ) {\n    enrolUsersInContent(\n      input: {\n        userIds: $userIds,\n        contentItemIds: $contentItemIds,\n        roleId: $roleId\n      }\n    ) {\n      status\n    }\n  }\n"])));function Y(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}var H=function(){var e=(0,b.D)(L),n=(0,v.Z)(e,2),r=n[0];return n[1],{enrolUsersInContent:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;r({variables:function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?Y(Object(r),!0).forEach(function(n){(0,g.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Y(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}({},e),refetchQueries:["GetUser"],onCompleted:n}).catch(function(e){})}}},z=(0,h.Ps)(u||(u=(0,O.Z)(['\n  mutation RemoveEnrolledContents(\n    $contentItemId: ID!\n    $userId: ID!\n    $roleIds: [ID!]\n  ) {\n    removeEnrolledContents(\n      input: {\n        contentItemId: $contentItemId\n        removeModel: "user"\n        userId: $userId\n        roleIds: $roleIds\n      }\n    ) {\n      status\n    }\n  }\n'])));function Q(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}var V=function(){var e=(0,b.D)(z),n=(0,v.Z)(e,2),r=n[0];return n[1],{unenrolUserFromContent:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;r({variables:function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?Q(Object(r),!0).forEach(function(n){(0,g.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}({},e),refetchQueries:["GetUser"],onCompleted:n}).catch(function(e){})}}},J=function(){var e=(0,s.t)().query.id,n=(0,f.Z)(e),r=(n.loading,n.error,n.user),t=H().enrolUsersInContent,o=V().unenrolUserFromContent;(0,w.useCallback)(function(e,n){if(!(null!=r&&r.id))return!1;t({userIds:[r.id],contentItemIds:[e.node.id],roleId:n.id})},[r]);var i=(0,w.useCallback)(function(e,n){if(!(null!=r&&r.id))return!1;o({userId:r.id,contentItemId:e.node.id})},[r]),l=(0,w.useMemo)(function(){return(null==r?void 0:r.courses.edges.filter(function(e){return!e.node._deleted}))||[]},[r]),u=(0,w.useMemo)(function(){return[{header:"Course",accessorFn:function(e){return e.node.title},cell:function(e){var n=e.cell.row.original.node;return(0,D.tZ)(S.Z,{title:n.title,image:n.image})}},{width:300,id:"Actions",cell:function(e){var n=e.cell,r=n.row.original;return(0,D.tZ)("div",{className:"text-right",children:n.row.original.groups.edges.length?(0,D.BX)(D.HY,{children:["Enrolled via group:",(0,D.BX)("strong",{children:[" ",n.row.original.groups.edges.map(function(e){return e.node.name}).join(", ")]})]}):(0,D.tZ)("a",{className:"text-red-600 hover:text-red-800",href:"#",onClick:function(){i(r,null)},children:"Unenrol from course"})})}}]},[]);return(0,D.tZ)($.Z,{tableData:l,tableCols:u})},K=r(58042),W=r(90116),ee=r(55103),en=r(71641),er=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=(0,en.a)(y.Mr,{variables:e?{id:e}:null}),r=n.loading,t=n.error,o=n.data,i=(o=void 0===o?{}:o).user;return{courses:null==i?void 0:i.courses,loading:r,error:t}},et=r(78773),eo=r(11762);r(65198);var ei=r(1717);function el(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function eu(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?el(Object(r),!0).forEach(function(n){(0,g.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):el(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var ea={option:function(e,n){return eu(eu({},e),{},{padding:8})},menuPortal:function(e,n){return eu(eu({},e),{},{zIndex:3e3})},input:function(e,n){return eu(eu({},e),{},{boxShadow:"none"})}},ec=function(e){return(0,D.tZ)(eo.c.Input,eu(eu({},e),{},{inputClassName:"outline-none border-none shadow-none focus:ring-transparent"}))},es=function(e){var n=e.data,r=e.onChange;return(0,D.tZ)(D.HY,{children:(0,D.tZ)(T.ZP,{placeholder:(0,D.tZ)("span",{className:"text-main-secondary",children:"Choose courses..."}),options:n,styles:ea,components:{Option:ei.Z,Input:ec},onChange:r,className:"w-full mb-4",isMulti:!0,isSearchable:!0,closeMenuOnSelect:!1,menuPortalTarget:document.body})})},ed=r(64202),ef=function(e){var n=e.user,r=(0,ee.Z)().courses,t=er(n.id).courses,o=H().enrolUsersInContent,i=(0,w.useContext)(I.t).closeModal,l=null==r?void 0:r.edges.map(function(e){return e.node}),u=null==t?void 0:t.edges.map(function(e){return e.node}),a=(null==l?void 0:l.filter(function(e){return!(null!=u&&u.some(function(n){return n.id===e.id}))}))||[],c=a.reduce(function(e,n,r,t){return[].concat((0,W.Z)(e),(0,W.Z)(n.tags.filter(function(n){return!e.some(function(e){return e.id===n.id})})))},[]),s=[],d=c.map(function(e){return{label:e.label,options:a.filter(function(n){return!s.some(function(e){return e.id===n.id})&&(s.push(n),n.tags.some(function(n){return n.id===e.id}))}).map(function(e){return{label:e.title,value:e.id}})}}),f=(0,U.Z)().roles,p=null==f?void 0:f.find(function(e){return"Learner"===e.name}),m=(0,w.useState)([]),g=m[0],v=m[1],b=function(e,n){v(e.map(function(e){return e.value}))},O=function(e){o({userIds:[n.id],contentItemIds:g,roleId:null==p?void 0:p.id},function(){i()})};return console.log("enrolUserInCourses"),console.log(r),console.log("availableCourses"),console.log(a),console.log("availableCoursesData"),console.log(d),(0,D.tZ)(D.HY,{children:n?null!=a&&a.length?(0,D.BX)("div",{children:[(0,D.tZ)(es,{data:d,onChange:b}),!!g.length&&!!(null!=p&&p.id)&&(0,D.tZ)(et.Z,{onClick:O,children:"Enrol ".concat(n.fullName," into ").concat(g.length," courses")})]}):(0,D.BX)("div",{className:"flex flex-col items-center",children:["No courses available for enrolment",(0,D.tZ)(et.Z,{onClick:i,children:"OK"})]}):(0,D.tZ)(ed.Z,{})})},ep=function(){var e=(0,s.t)().query.id,n=(0,f.Z)(e),r=n.user;n.loading,n.error;var t=(0,w.useContext)(I.t).handleModal;return(0,D.tZ)(C,{title:"Courses",icon:K.X,button:{text:"Assign courses",onClick:function(){t({title:"Enrol user in courses",content:(0,D.tZ)(ef,{user:r})})}},children:(0,D.tZ)(J,{})})},em=r(21840),eg=function(){var e=(0,s.t)().query.id,n=(0,f.Z)(e),r=(n.loading,n.error,n.user),t=H().enrolUsersInContent,o=V().unenrolUserFromContent;(0,w.useCallback)(function(e,n){if(!(null!=r&&r.id))return!1;t({userIds:[r.id],contentItemIds:[e.node.id],roleId:n.id})},[r]);var i=(0,w.useCallback)(function(e,n){if(!(null!=r&&r.id))return!1;o({userId:r.id,contentItemId:e.node.id})},[r]),l=(0,w.useMemo)(function(){return(null==r?void 0:r.resources.edges.filter(function(e){return!e.node._deleted}))||[]},[r]),u=(0,w.useMemo)(function(){return[{header:"Resource",accessorFn:function(e){return e.node.title},cell:function(e){var n=e.cell.row.original.node;return(0,D.tZ)(S.Z,{title:n.title,image:n.image})}},{width:300,id:"Actions",cell:function(e){var n=e.cell,r=n.row.original;return(0,D.tZ)("div",{className:"text-right",children:n.row.original.groups.edges.length?(0,D.BX)(D.HY,{children:["Enrolled via group:",(0,D.BX)("strong",{children:[" ",n.row.original.groups.edges.map(function(e){return e.node.name}).join(", ")]})]}):(0,D.tZ)("a",{className:"text-red-600 hover:text-red-800",href:"#",onClick:function(){i(r,null)},children:"Unassign resource"})})}}]},[]);return(0,D.tZ)($.Z,{tableData:l,tableCols:u})},ev=function(){var e=(0,s.t)().query.id,n=(0,f.Z)(e);return n.user,n.loading,n.error,(0,w.useContext)(I.t).handleModal,(0,D.tZ)(C,{title:"Resources",icon:em.Z,button:{text:"Assign items",onClick:function(){}},children:(0,D.tZ)(eg,{})})},eb=r(39316),eO=r(69291),eh=r(76322),ey=r(50196),eZ=["profile_image","invite"],ej=function(){return(0,D.BX)(D.HY,{children:[(0,D.tZ)("span",{className:"hidden lg:block",children:"Back to user list"}),(0,D.tZ)("span",{className:"block lg:hidden",children:(0,D.tZ)(eb.x,{width:"20"})})]})},eP=function(){var e=(0,s.t)(),n=e.query.id,r=(0,f.Z)(n),t=r.user;r.loading,r.error;var o=(0,p.Z)(n).updateUser,i=P().updateUserTenantRoles,l=(0,eO.Z)({method:"PUT"}).uploadFileAndNotify,u=function(r){var t=r.profile_image,u=r.invite,c=(0,a.Z)(r,eZ),s=localStorage.getItem("token");o(c,function(){return i({userId:n,roleIds:c.role_ids})}),u&&ey.ZP.request({method:"post",url:"/api/v1/users/send_invitation",headers:{Authorization:"Bearer ".concat(s)},data:{emails:[c.email]}}).then(function(e){}),t&&t instanceof File&&l(t,"profile_image","/api/v1/users/".concat(n,"/update_profile_image")),e.push("/admin/users")};return(0,c.Z)({title:"Edit User".concat(t?": ".concat(t.fullName):"")}),(0,d.Z)([[(0,D.tZ)(ej,{}),"/admin/users"]]),(0,D.tZ)(D.HY,{children:t?(0,D.BX)("div",{className:"flex space-x-0 flex-col w-full max-w-screen-lg md:flex-row md:space-x-11",children:[(0,D.tZ)(m.Z,{onSubmit:u,user:t}),(0,D.BX)("div",{className:"flex flex-col w-full space-y-8 mt-4 md:mt-0",children:[(0,D.tZ)(G,{}),(0,D.tZ)(ep,{}),(0,D.tZ)(ev,{})]})]}):(0,D.tZ)(ed.Z,{text:(0,D.BX)(D.HY,{children:["Loading user details",(0,D.tZ)(eh.o,{children:"."}),(0,D.tZ)(eh.o,{children:"."}),(0,D.tZ)(eh.o,{children:"."})]})})})};eP.navState={topLevel:"users",secondary:"users"};var ew=eP},44348:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/users/edit",function(){return r(94781)}])},50319:function(e,n,r){"use strict";r.d(n,{D:function(){return s}});var t=r(70655),o=r(67294),i=r(14012),l=r(82152),u=r(14692),a=r(30990),c=r(66252);function s(e,n){var r=(0,c.x)(null==n?void 0:n.client);(0,u.Vp)(e,u.n_.Mutation);var s=(0,o.useState)({called:!1,loading:!1,client:r}),d=s[0],f=s[1],p=(0,o.useRef)({result:d,mutationId:0,isMounted:!0,client:r,mutation:e,options:n});Object.assign(p.current,{client:r,options:n,mutation:e});var m=(0,o.useCallback)(function(e){void 0===e&&(e={});var n=p.current,r=n.client,o=n.options,u=n.mutation,c=(0,t.pi)((0,t.pi)({},o),{mutation:u});p.current.result.loading||c.ignoreResults||!p.current.isMounted||f(p.current.result={loading:!0,error:void 0,data:void 0,called:!0,client:r});var s=++p.current.mutationId,d=(0,i.J)(c,e);return r.mutate(d).then(function(n){var t,o,i,u=n.data,c=n.errors,m=c&&c.length>0?new a.c({graphQLErrors:c}):void 0;if(s===p.current.mutationId&&!d.ignoreResults){var g={called:!0,loading:!1,data:u,error:m,client:r};p.current.isMounted&&!(0,l.D)(p.current.result,g)&&f(p.current.result=g)}return null===(o=null===(t=p.current.options)||void 0===t?void 0:t.onCompleted)||void 0===o||o.call(t,n.data,d),null===(i=e.onCompleted)||void 0===i||i.call(e,n.data,d),n}).catch(function(n){var t,o,i,u;if(s===p.current.mutationId&&p.current.isMounted){var a={loading:!1,error:n,data:void 0,called:!0,client:r};(0,l.D)(p.current.result,a)||f(p.current.result=a)}if((null===(t=p.current.options)||void 0===t?void 0:t.onError)||d.onError)return null===(i=null===(o=p.current.options)||void 0===o?void 0:o.onError)||void 0===i||i.call(o,n,d),null===(u=e.onError)||void 0===u||u.call(e,n,d),{data:void 0,errors:n};throw n})},[]),g=(0,o.useCallback)(function(){p.current.isMounted&&f({called:!1,loading:!1,client:r})},[]);return(0,o.useEffect)(function(){return p.current.isMounted=!0,function(){p.current.isMounted=!1}},[]),[m,(0,t.pi)({reset:g},d)]}}},function(e){e.O(0,[9299,6107,6644,7216,4723,9774,2888,179],function(){return e(e.s=44348)}),_N_E=e.O()}]);