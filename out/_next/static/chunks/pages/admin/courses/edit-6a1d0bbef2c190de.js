(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[304],{99083:function(e,t,n){"use strict";var r=n(67294),o=n(87536),c=n(95815),i=n(28024),a=n(35944),l=function(e){var t=e.placeholder,n=e.buttonText,l=e.control,s=e.name,u=e.origImage,d=e.onSelect,f=e.className,p=e.isButtonAlwaysVisible,b=(0,o.bc)({control:l,name:s}).field,m=(0,r.useContext)(c.t).closeModal,v=(0,r.useState)(u),y=v[0],g=v[1],O=function(e){b.onChange((null==e?void 0:e.id)||null),g(e),d?d(e):m()};return(0,a.tZ)(a.HY,{children:(0,a.tZ)(i.Z,{className:void 0===f?"":f,placeholder:t,src:null==y?void 0:y.location,buttonText:n,onSelect:O,isButtonAlwaysVisible:void 0===p||p})})};t.Z=l},4517:function(e,t,n){"use strict";var r=n(87536),o=n(67294),c=n(5152),i=n.n(c),a=n(35944),l=i()(function(){return Promise.all([n.e(2937),n.e(9584),n.e(4033),n.e(246)]).then(n.bind(n,246))},{ssr:!1,loadableGenerated:{webpack:function(){return[246]}}}),s=function(e){var t=e.control,n=e.name,c=e.label,i=e.initialValue,s=(0,o.useRef)();(0,o.useEffect)(function(){console.log("editorRef"),console.log(s)},[]);var u=(0,o.useState)(void 0===i?null:i),d=u[0],f=u[1],p=(0,r.bc)({control:t,name:n}).field,b=function(e){f(e),p.onChange(e)};return(0,a.BX)(a.HY,{children:[(0,a.tZ)("label",{className:"block",children:(0,a.tZ)("span",{className:"text-sm font-medium text-gray-700",children:c})}),(0,a.tZ)(l,{ref:s,id:"rte",value:d,onChange:b,className:"flex-grow z-0"})]})};t.Z=s},1717:function(e,t,n){"use strict";var r=n(59499),o=n(11762),c=n(35944);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var l=o.c.Option,s=function(e){var t;return(0,c.BX)(l,a(a({},e),{},{className:"flex bg-main h-10 py-1 space-x-2 text-main-secondary",children:[(null===(t=e.data)||void 0===t?void 0:t.icon)&&(0,c.tZ)(e.data.icon,{className:"h-full text-main-secondary"}),(0,c.tZ)("span",{className:"text-main-secondary",children:e.data.label})]}))};t.Z=s},23968:function(e,t,n){"use strict";var r=n(4730),o=n(59499),c=n(78773),i=n(87536),a=n(97088),l=n(67294),s=n(99083),u=n(69726),d=n(95815),f=n(4517),p=n(35944),b=["__typename","image"];function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach(function(t){(0,o.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var y=function e(t){var n,o,m=t.course,y=void 0===m?null:m,g=t.onSubmit,O=t.isModal,h=void 0!==O&&O,Z=t.submitButtonText,j=v(v({},y),{},{tags:(null==y?void 0:null===(n=y.tags)||void 0===n?void 0:n.map(function(e){return e.__typename,e.image,(0,r.Z)(e,b)}))||[]}),w=(0,l.useContext)(d.t).handleModal,P=(0,i.cI)({defaultValues:j}),x=P.register,S=(P.watch,P.handleSubmit),N=P.control,C=P.setFocus,D=P.getValues,_=(P.setValue,P.formState.errors);(0,l.useEffect)(function(){C("title")},[]);var E=function(t){w({title:"Course settings",size:"lg",content:(0,p.tZ)(e,{course:v(v({},D()),{},{image:t}),isModal:!0,onSubmit:g,submitButtonText:"Save settings"})})};return(0,p.BX)("form",{onSubmit:S(g),className:"flex flex-col items-center space-y-4",children:[(0,p.BX)("div",{className:"flex space-x-6 max-w-screen-xl",children:[(0,p.BX)("div",{className:"".concat(!h&&"w-1/2"," flex flex-col space-y-4"),children:[(0,p.tZ)(a.Z,{label:"Course name",placeholder:"Untitled course",inputAttrs:x("title",{required:"Course name is required"})}),_.title&&(0,p.tZ)("small",{className:"text-danger text-red-500",children:_.title.message}),(0,p.tZ)("div",{className:"max-w-5xl shadow bg-main/10",children:(0,p.tZ)(s.Z,{buttonText:"Choose course image",className:h?"max-w-sm":"",origImage:null==j?void 0:j.image,control:N,name:"imageId",onSelect:h?E:null,class:!0})}),(0,p.tZ)(u.Z,{control:N,tagType:"category",label:"Categories"})]}),!h&&(0,p.tZ)("div",{className:"w-1/2 flex flex-col",children:(0,p.tZ)(f.Z,{initialValue:null==y?void 0:null===(o=y.content)||void 0===o?void 0:o.description,label:"Description",name:"content",control:N})})]}),(0,p.tZ)(c.Z,{type:"submit",children:void 0===Z?"Submit":Z})]})};t.Z=y},69726:function(e,t,n){"use strict";var r=n(4730),o=n(59499),c=n(58779),i=n(39299),a=n(87536),l=n(35944),s=["__typename","image"],u=["__typename","image","_deleted"];function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach(function(t){(0,o.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var p=function(e){var t,n=e.control,o=e.tagType,d=e.label,p=(0,c.Z)(),b=p.tags;p.loading,p.error;var m=(0,a.bc)({control:n,name:"tags"}).field,v=f({isMulti:!0,options:b&&b.filter(function(e){return e.tagType===o}),value:null===(t=m.value)||void 0===t?void 0:t.map(function(e){return e.__typename,e.image,(0,r.Z)(e,s)}),getOptionValue:function(e){var t;return null!==(t=e.value)&&void 0!==t?t:e.id},onChange:function(e){m.onChange(e.map(function(e){return e.__typename,e.image,e._deleted,(0,r.Z)(e,u)}))},className:"w-full",isSearchable:!1,styles:{menuPortal:function(e){return f(f({},e),{},{zIndex:9999})}}},{menuPortalTarget:document.body});return(0,l.tZ)(l.HY,{children:b&&(0,l.BX)("label",{className:"block z-50",children:[d&&(0,l.tZ)("span",{className:"text-sm font-medium text-gray-700",children:d}),(0,l.tZ)(i.ZP,f({},v))]})})};t.Z=p},58779:function(e,t,n){"use strict";var r=n(71641),o=n(54232);t.Z=function(){var e=(0,r.a)(o.F$),t=e.loading,n=e.error,c=e.data;return{tags:(c=void 0===c?{}:c).tags,loading:t,error:n}}},79794:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return q}});var r=n(4730),o=n(59499),c=n(40350),i=n(13433),a=n(24249),l=n(53833),s=n(67294),u=n(39299),d=n(94225),f=n(1312),p=n(66507),b=n(1717),m=n(41637),v=n(35944);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach(function(t){(0,o.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var O=Object.keys(m.f).map(function(e){return g(g({},m.f[e]),{},{value:e})}),h={option:function(e,t){return g(g({},e),{},{padding:8})}},Z=function(e){var t=e.sectionId,n=e.placeholder,r=e.onSelect,o=void 0===r?function(){return null}:r,c=(0,f.Z)(t),i=c.createLesson,a=c.lesson,l=(0,p.Z)().updateLesson,m=function(e){i({content:e.content,contentType:e.value}),o()};return(0,s.useEffect)(function(){a&&(0,d.Nt)({type:"lesson",id:a.id,updateFunction:l(a.id)})},[a]),(0,v.tZ)(u.ZP,{placeholder:(0,v.tZ)("span",{className:"text-main-secondary",children:void 0===n?"Choose a lesson type...":n}),options:O,styles:h,components:{Option:b.Z},onChange:m,value:null,className:"w-full",isSearchable:!1,closeMenuOnSelect:!0})},j=n(66944),w=function(){var e,t,n=(0,a.t)().query,r=n.id,o=n.cid,c=(0,j.Z)(r).courses,u=null==c?void 0:null===(e=c.edges[0])||void 0===e?void 0:e.node,f=(0,i.l)(d.Nt),b=(0,p.Z)(o).updateLesson;return(0,s.useEffect)(function(){if(u&&!o){var e,t=null==u?void 0:null===(e=u.sections.find(function(e){var t;return null===(t=e.lessons)||void 0===t?void 0:t.length}))||void 0===e?void 0:e.lessons[0];t&&(0,d.Nt)({id:t.id,type:"lesson",title:t.title,updateFunction:b(t.id)})}else(0,d.Nt)({id:o,type:"lesson",title:"",updateFunction:b(o)})},[r,o]),(0,v.tZ)(v.HY,{children:f.id?(0,v.tZ)(l.Z,{}):(0,v.tZ)("div",{className:"mx-auto my-0 space-y-4 h-full self-center flex flex-col justify-center items-center w-full max-w-sm",children:(0,v.tZ)(Z,{sectionId:null===(t=u.sections[0])||void 0===t?void 0:t.id,placeholder:"Create your first lesson"})})})},P=n(60518),x=n(10615),S=n(17674),N=n(28626),C=n(22345),D=n(50319);function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach(function(t){(0,o.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var k=function(e){var t=(0,D.D)(N.x),n=(0,S.Z)(t,2),r=n[0];n[1];var o=function(t){var n=d.ZP.readFragment({id:"ContentItem:".concat(e),fragment:C.mk,fragmentName:"CourseFragment"});r({variables:E({id:e},t),optimisticResponse:{updateCourse:{__typename:"UpdateCoursePayload",course:E(E({},n),t)}}}).catch(function(e){})},c=function(e){o({content:{blocks:e}})};return{updateCourse:o,updateCourseContentBlocks:c}},B=n(95815),T=n(23968),I=n(83342),X=n(78773),M=n(55678),F=function(){var e=(0,i.l)(d.Nt),t=e.id,n=e.updateFunction,r=(0,I.ri)(function(e){return e.blocks}),o=(0,I.ri)(function(e){return e.isDirty}),c=(0,I.ri)(function(e){return e.setIsDirty}),a=(0,s.useCallback)(function(){n({content:{blocks:r}}).then(function(e){c(!1),(0,M.Am)("Changes saved.",{toastId:"changesSaved",hideProgressBar:!0,autoClose:2500})})},[r,o,n]);(0,s.useEffect)(function(){(0,d.ac)((0,v.tZ)(v.HY,{children:(0,v.tZ)(X.Z,{disabled:!o,onClick:a,children:"Save Changes"})}))},[t,a,o])},V=n(64202),H=n(76322),Y=["content"];function z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?z(Object(n),!0).forEach(function(t){(0,o.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var G=function(){var e=(0,a.t)().query.id,t=(0,j.Z)(e).courseEdge,n=null==t?void 0:t.node;(0,s.useEffect)(function(){n&&console.log(n)},[n]);var o=k(e).updateCourse;(0,s.useEffect)(function(){var e=L({isSlimNav:!0,showSecondary:!1},(0,d.G4)());return(0,d.G4)(e),function(){var e=(0,d.G4)();delete e.showSecondary;var t=L(L({},e),{},{isSlimNav:!0});(0,d.G4)(t)}},[]);var i=(0,s.useContext)(B.t),l=i.handleModal,u=i.closeModal,f=function(e){o(L({content:{description:e.content}},(0,r.Z)(e,Y))),u()},p=function(){l({title:"Course settings",size:"lg",content:(0,v.tZ)(T.Z,{course:n,isModal:!0,onSubmit:f,submitButtonText:"Save settings"})})};return(0,c.Z)({title:"Course".concat(null!=n&&n.title?": ":""),editable:(null==n?void 0:n.title)||"",onEdit:function(e){return o({title:e})},after:(0,v.tZ)("div",{className:"p-2 ml-2 cursor-pointer",onClick:p,children:(0,v.tZ)(x.X,{size:"18"})})}),F(),(0,v.tZ)(v.HY,{children:n?(0,v.tZ)(w,{}):(0,v.tZ)(V.Z,{text:(0,v.BX)(v.HY,{children:["Loading your course",(0,v.tZ)(H.o,{children:"."}),(0,v.tZ)(H.o,{children:"."}),(0,v.tZ)(H.o,{children:"."})]})})})};G.navState={topLevel:"courses",secondary:"courses"},G.getLayout=function(e){return(0,v.tZ)(P.Z,{navState:G.navState||{},page:e})};var q=G},96363:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/courses/edit",function(){return n(79794)}])}},function(e){e.O(0,[9299,6107,5756,2110,5213,2536,5880,9525,3434,6353,6552,9774,2888,179],function(){return e(e.s=96363)}),_N_E=e.O()}]);